---
name: tdd
description: TDDサイクル（Red→Green→Refactor）を実行し、テスト作成→実装→リファクタリングまで導く。
disable-model-invocation: true
---

# TDD サイクル

## 前提条件

- 対象 Issue の分析と実装方針の提示が済んでること
- 作業ブランチへのチェックアウトが済んでること
- テスト対象のコンポーネント・機能が特定されていること

---

## Step 1: Red（失敗するテストを書く）

1. テストファイルを作成・更新する
   - 配置先: `components/__tests__/<Name>.test.tsx` または `lib/__tests__/<name>.test.ts`
   - 既存テストの規約に合わせて書く
2. 実装すべき機能の振る舞いを記述したテストを書く
3. テストコードをユーザーに提示し承認を得る
4. 承認後 `npm test` を実行
5. **テストが失敗することを確認**（Red）→ 結果をユーザーに報告

---

## Step 2: Green（テストを通す実装）

1. テストを通すための**最小限の実装コード**を作成する
2. 実装コードをユーザーに提示し承認を得る
3. 承認後 `npm test` を実行
4. **テストが全て成功することを確認**（Green）
5. `npm run build` でビルドエラーがないか確認
6. テスト結果とビルド結果をユーザーに報告

---

## Step 3: Refactor（リファクタリング）

1. コードの改善点を分析し、リファクタリング案をユーザーに提示する
2. ユーザーが「承認」「スキップ」いずれかを選択
3. 承認の場合はリファクタリングを実施し `npm test` で確認
4. 結果をユーザーに報告

---

## 規約チェックリスト

- [ ] テスト対象は1つの機能・コンポーネントに限定
- [ ] `any` 型は使用しない
- [ ] インターフェースは `types/index.ts` に集約
- [ ] `'use client'` が必要なコンポーネントに付与されている
- [ ] Tailwind はインラインクラスのみ（外部CSS禁止）
